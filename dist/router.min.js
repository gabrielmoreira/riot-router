!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("riot")):"function"==typeof define&&define.amd?define(["riot"],e):"object"==typeof exports?exports.Router=e(require("riot")):t.Router=e(t.riot)}(this,function(t){return function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var r={};return e.m=t,e.c=r,e.p="/dist/",e(0)}([function(t,e,r){var n,i,o;!function(u,a){i=[t,r(1),r(2),r(4)],n=a,o="function"==typeof n?n.apply(e,i):n,!(void 0!==o&&(t.exports=o))}(this,function(t,e,r,n){"use strict";var i=n.create({route:r});window&&(window.router=i),t.exports=n})},function(e,r){e.exports=t},function(t,e,r){"use strict";function n(t){return t&&"object"==typeof t&&"default"in t?t.default:t}function i(t){return t.split(/[\/?#]/)}function o(t,e){var r=e.replace(/\?/g,"\\?").replace(/\*/g,"([^/?#]+?)").replace(/\.\./,".*"),n=new RegExp("^"+r+"$"),i=t.match(n);if(i)return i.slice(1)}function u(t,e){var r;return function(){clearTimeout(r),r=setTimeout(t,e)}}function a(t){y=u(l,1),A[k](P,y),A[k](j,y),E[k]($,d),t&&l(!0)}function s(){this.$=[],_(this),D.on("stop",this.s.bind(this)),D.on("emit",this.e.bind(this))}function c(t){return t.replace(/^\/|\/$/,"")}function f(t){return"string"==typeof t}function p(t){return(t||C.href).replace(w,"")}function h(t){var e=L._.base;return"#"===e[0]?(t||C.href||"").split(e)[1]||"":(C?p(t):t||"").replace(e,"")}function l(t){var e=0===z;if(!(q<=z)&&(z++,I.push(function(){var e=h();(t||e!==g)&&(D[T]("emit",e),g=e)}),e)){for(var r;r=I.shift();)r();z=0}}function d(t){if(!(1!==t.which||t.metaKey||t.ctrlKey||t.shiftKey||t.defaultPrevented)){for(var e=t.target;e&&"A"!==e.nodeName;)e=e.parentNode;if(e&&"A"===e.nodeName&&!e[R]("download")&&e[R]("href")&&(!e.target||"_self"===e.target)&&e.href.indexOf(C.href.match(w)[0])!==-1){var r=L._.base;e.href!==C.href&&(e.href.split("#")[0]===C.href.split("#")[0]||"#"!==r[0]&&0!==p(e.href).indexOf(r)||"#"===r[0]&&e.href.split(r)[0]!==C.href.split(r)[0]||!v(h(e.href),e.title||E.title))||t.preventDefault()}}}function v(t,e,r){return S?(t=L._.base+c(t),e=e||E.title,r?S.replaceState(null,e,t):S.pushState(null,e,t),E.title=e,U=!1,l(),U):D[T]("emit",h(t))}var y,g,m,b,_=n(r(3)),w=/^.+?\/\/+[^\/]+/,O="EventListener",x="remove"+O,k="add"+O,R="hasAttribute",P="popstate",j="hashchange",T="trigger",q=3,A="undefined"!=typeof window&&window,E="undefined"!=typeof document&&document,S=A&&history,C=A&&(S.location||A.location),N=s.prototype,$=E&&E.ontouchstart?"touchstart":"click",D=_(),M=!1,U=!1,I=[],z=0;N.m=function(t,e,r){!f(t)||e&&!f(e)?e?this.r(t,e):this.r("@",t):v(t,e,r||!1)},N.s=function(){this.off("*"),this.$=[]},N.e=function(t){this.$.concat("@").some(function(e){var r=("@"===e?m:b)(c(t),c(e));if("undefined"!=typeof r)return this[T].apply(null,[e].concat(r)),U=!0},this)},N.r=function(t,e){"@"!==t&&(t="/"+c(t),this.$.push(t)),this.on(t,e)};var F=new s,L=F.m.bind(F);L._={base:null,getPathFromBase:h},L.create=function(){var t=new s,e=t.m.bind(t);return e.stop=t.s.bind(t),e},L.base=function(t){L._.base=t||"#",g=h()},L.exec=function(){l(!0)},L.parser=function(t,e){t||e||(m=i,b=o),t&&(m=t),e&&(b=e)},L.query=function(){var t={},e=C.href||g;return e.replace(/[?&](.+?)=([^&]*)/g,function(e,r,n){t[r]=n}),t},L.stop=function(){M&&(A&&(A[x](P,y),A[x](j,y),E[x]($,d)),D[T]("stop"),M=!1)},L.start=function(t){M||(A&&("interactive"===document.readyState||"complete"===document.readyState?a(t):document.onreadystatechange=function(){"interactive"===document.readyState&&setTimeout(function(){a(t)},1)}),M=!0)},L.base(),L.parser(),t.exports=L},function(t,e,r){!function(e,r){var n=function(t){t=t||{};var e={},r=Array.prototype.slice;return Object.defineProperties(t,{on:{value:function(r,n){return"function"==typeof n&&(e[r]=e[r]||[]).push(n),t},enumerable:!1,writable:!1,configurable:!1},off:{value:function(r,n){if("*"!=r||n)if(n)for(var i,o=e[r],u=0;i=o&&o[u];++u)i==n&&o.splice(u--,1);else delete e[r];else e={};return t},enumerable:!1,writable:!1,configurable:!1},one:{value:function(e,r){function n(){t.off(e,n),r.apply(t,arguments)}return t.on(e,n)},enumerable:!1,writable:!1,configurable:!1},trigger:{value:function(n){var i,o,u,a=arguments.length-1,s=new Array(a);for(u=0;u<a;u++)s[u]=arguments[u+1];for(i=r.call(e[n]||[],0),u=0;o=i[u];++u)o.apply(t,s);return e["*"]&&"*"!=n&&t.trigger.apply(t,["*",n].concat(s)),t},enumerable:!1,writable:!1,configurable:!1}}),t};t.exports=n}("undefined"!=typeof window?window:void 0)},function(t,e,r){var n,i,o;(function(u){!function(u,a){i=[t,r(1),r(5)],n=a,o="function"==typeof n?n.apply(e,i):n,!(void 0!==o&&(t.exports=o))}(this,function(t,e,r){"use strict";function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t){e.tag("route","<router-content></router-content>","","",function(n){this.calculateLevel=function(t){var e=0;return t.parent&&(e+=this.calculateLevel(t.parent)),t.opts.__router_level&&(e+=t.opts.__router_level),t.__router_tag&&(e+=1),e}.bind(this),this.normalizeTag=function(t,e,r){var n=t(e,r);return"string"==typeof n?t=n:(t=n.tag||t,e=n.api||e),[t,e,r]},this.unmountTag=function(){this.instance&&this.instance.unmount(!0)},this.mountTag=function(t,r,n){if("function"==typeof t){var i=this.normalizeTag(t,r,n),o=f(i,3);t=o[0],r=o[1],n=o[2]}if(console.log("tag, api, options",t,r,n),this.canUpdate(t,r,n))console.log("UPDATE UPDATE!!!"),this.instance.update({opts:r});else if(this.unmountTag(),t){this.root.replaceChild(document.createElement(t),this.root.children[0]);try{this.instance=e.mount(this.root.children[0],t,r)[0]}catch(e){return void l("Error when mounting tag '"+t+"'.",e)}this.instanceTag=t,this.instanceApi=r}},this.canUpdate=function(e,r,i){return i.updatable!==!1&&!!((t.config.updatable||n.updatable||i.updatable)&&this.instance&&this.instance.isMounted&&this.instanceTag===e)},this.updateRoute=function(){var e={tag:null};if(t&&t.current){var i=t.current;if(this.level<=i.size()){var o=i.get(this.level);if(o){var u=o.params||{},a=i.query||{},s=r(!0,{},n,a,o.api,u,{__router_level:this.level,query:a});e={tag:o.tag,api:s,updatable:o.route.updatable}}}}e.tag?this.mountTag(e.tag,e.api,e):this.unmountTag()}.bind(this),this.__router_tag="route",this.level=this.calculateLevel(this),t.on("route:updated",this.updateRoute),this.on("unmount",function(){t.off("route:updated",this.updateRoute),this.unmountTag()}.bind(this)),this.on("mount",this.updateRoute)})}function s(){var t=e.route||window&&window.route||u&&u.route;return t}function c(t){var e=new d;return e.configure(r(!0,{updatable:!0,route:s(),base:"#",parser:function(t){var e=t.split("?"),r=e[0].split("/"),n=e[1],i={};return n&&n.split("&").forEach(function(t){var e=t.split("=");i[e[0]]=e[1]}),r.push(i),r}},t)),a(e),d.instance||(d.instance=e),e}var f=function(){function t(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var u,a=t[Symbol.iterator]();!(n=(u=a.next()).done)&&(r.push(u.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw o}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),p=function t(e,r,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,r);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,r,n)}if("value"in i)return i.value;var u=i.get;if(void 0!==u)return u.call(n)},h=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),l=console&&console.error||function(){},d=function(){function t(){o(this,t),e.observable(this),this.interceptors=[this.processRoute.bind(this)],this.handler=new m,this.current=new v("").response,this.process=this.process.bind(this)}return h(t,[{key:"route",value:function(t){this.handler=t}},{key:"routes",value:function(t){this.route((new m).routes(t))}},{key:"use",value:function(t){this.interceptors.push(t)}},{key:"process",value:function(){var t=Array.prototype.slice.call(arguments),e={},r=t.filter(function(t){return"string"==typeof t||(e=t,!1)}).join("/");"/"!==r[0]&&(r="/"+r);var n=new v(new x(r,e));return this.rootContext||(this.rootContext=n),this.processRequest(n),n}},{key:"processRequest",value:function(t){return this.processInterceptors(t),this.processResponse(t)}},{key:"processResponse",value:function(t){if(this.isRedirect(t))return this.processRedirect(t);var e=(t.request,t.response);return e.redirectTo?void 0:(this.current=e,this.rootContext=null,this.trigger("route:updated",e),t)}},{key:"isRedirect",value:function(t){return!!t.response.redirectTo}},{key:"processRedirect",value:function(t){var e=t.response.redirectTo;this.rootContext.addRedirect(e),this.navigateTo(e)}},{key:"navigateTo",value:function(){var t=Array.prototype.slice.call(arguments);"boolean"==typeof t[1]&&t.splice(1,0,""),this.config.route.apply(null,t)}},{key:"processInterceptors",value:function(t,e,r){var n=(e||[]).concat(this.interceptors).concat(r||[]),i=function e(){if(!t.stop){var r=n.shift(),i=t.request,o=t.response;if(r)return r(i,o,e,t)}return t};return i()}},{key:"processRoute",value:function(t,e,r,n){return this.handler.process(t,e,n),r()}},{key:"start",value:function(){this.config.route.start(),this.exec()}},{key:"exec",value:function(){this.config.route.exec(this.process)}},{key:"configure",value:function(t){this.config=r(!0,{},this.config,t),this.config.route.parser&&this.config.parser&&this.config.route.parser(this.config.parser),this.config.route.base&&this.config.base&&this.config.route.base(this.config.base),this.config.route(this.process)}}]),t}(),v=function(){function t(e){o(this,t),this.request="string"==typeof e?new x(e):e,this.response=new k(this.request),this.redirectStack=[]}return h(t,[{key:"addRedirect",value:function(t){if(this.redirectStack.indexOf(t)>-1)throw new Error("Cyclic redirection to "+t+". Stack = "+this.redirectStack);this.redirectStack.push(t)}}]),t}(),y=function(){function t(){o(this,t)}return h(t,[{key:"matches",value:function(t){return!1}},{key:"process",value:function(t,e){var r=this.matches(t);return r?this.routeMatch(t,e,r):this.routeMiss(t,e)}},{key:"routeMatch",value:function(t,e,r){return e.add(r),!0}},{key:"routeMiss",value:function(t,e){return!1}},{key:"processRoutes",value:function(t,e,r){if(r&&r.length){for(var n=r.length,i=0;i<n;i++){var o=r[i];if(o.process(t,e))return!0}return!1}}},{key:"createRequest",value:function(t,e){return new b(t,e)}}]),t}(),g=function(t){function e(t){o(this,e);var r=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));t=t||{},r.tag=t.tag,r.api=t.api,r.path=t.path,r.name=t.name,r.updatable=t.updatable,r.pathParameterNames=[];var i=r.getPath().replace(/^\//,"");return r.pattern="^/?"+i.replace(/:([^\/]+)/g,function(t,e){return this.pathParameterNames.push(e),"([^/]+)"}.bind(r))+"(:?/|$)",r.regex=new RegExp(r.pattern),r}return i(e,t),h(e,[{key:"routes",value:function(t){var e=t.filter(function(t){return t instanceof w}),r=t.filter(function(t){return t instanceof O}),n=t.filter(function(t){return t instanceof _}),i=t.filter(function(t){return e.indexOf(t)===-1&&r.indexOf(t)===-1&&n.indexOf(t)===-1});return n.length>1&&l("Can't use more than one NotFoundRoute per route. --> "+this.getPath()),r.length>1&&l("Can't use more than one DefaultRoute per route. --> "+this.getPath()),this._routes=[].concat(e).concat(i).concat(r).concat(n),this}},{key:"matches",value:function(t){var e=this.regex.exec(t.uri);if(e){var r={};for(var n in this.pathParameterNames)if(this.pathParameterNames.hasOwnProperty(n)){var i=this.pathParameterNames[n];r[i]=decodeURIComponent(e[parseInt(n,10)+1])}return{route:this,tag:this.tag,api:this.api,found:e[0],params:r}}return!1}},{key:"routeMatch",value:function(t,r,n){var i=p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"routeMatch",this).call(this,t,r,n);return this.processRoutes(t,r,n),i}},{key:"processRoutes",value:function(t,r,n){return p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"processRoutes",this).call(this,this.createRequest(t,n),r,this._routes)}},{key:"getPath",value:function(){return this.name||this.path||("string"==typeof this.tag?this.tag:"")}}]),e}(y),m=function(t){function e(){return o(this,e),n(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),e}(g),b=function t(e,r){o(this,t),this.request=e,this.matcher=r,this.uri=this.request.uri.substring(r.found.length),this.parentUri=this.request.uri.substring(0,r.found.length),this.query=this.request.query},_=function(t){function e(t){o(this,e);var r=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return t=t||{},r.tag=t.tag,r.api=t.api,r}return i(e,t),h(e,[{key:"matches",value:function(t){return{route:this,tag:this.tag,api:this.api,found:t.uri}}}]),e}(y),w=function(t){function e(t){o(this,e);var r=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return t=t||{},r.from=t.from,r.to=t.to,r.pattern="(^/?)"+r.from+"(/|$)",r.regex=new RegExp(r.pattern),r}return i(e,t),h(e,[{key:"process",value:function(t,e){var r=t.uri.replace(this.regex,"$1"+this.to+"$2");if(r!==t.uri){var n=t.parentUri||"";return e.redirectTo=n+r,!0}}}]),e}(y),O=function(t){function e(t){o(this,e);var r=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return t=t||{},r.tag=t.tag,r.api=t.api,r}return i(e,t),h(e,[{key:"matches",value:function(t){var e=t.uri.trim();if("/"===e||""===e)return{route:this,tag:this.tag,api:this.api,found:e}}}]),e}(y),x=function t(e,r){o(this,t),this.uri=e,this.query=r},k=function(){function t(e){o(this,t),this.uri=e.uri,this.matches=[],this.params={},this.query=e.query}return h(t,[{key:"add",value:function(t){this.matches.push(t);var e=t.params;if(e)for(var r in e)e.hasOwnProperty(r)&&(this.params[r]=e[r])}},{key:"get",value:function(t){return this.matches[t]}},{key:"size",value:function(){return this.matches.length}},{key:"isEmpty",value:function(){return this.matches.length}}]),t}();d.create=c,d.Route=g,d.DefaultRoute=O,d.RedirectRoute=w,d.NotFoundRoute=_,d._={Response:k,Request:x},t.exports=d})}).call(e,function(){return this}())},function(t,e){"use strict";var r=Object.prototype.hasOwnProperty,n=Object.prototype.toString,i=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===n.call(t)},a=function(t){if(!t||"[object Object]"!==n.call(t))return!1;var e=r.call(t,"constructor"),i=t.constructor&&t.constructor.prototype&&r.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!e&&!i)return!1;var o;for(o in t);return"undefined"==typeof o||r.call(t,o)},s=function(t,e){i&&"__proto__"===e.name?i(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},c=function(t,e){if("__proto__"===e){if(!r.call(t,e))return;if(o)return o(t,e).value}return t[e]};t.exports=function t(){var e,r,n,i,o,f,p=arguments[0],h=1,l=arguments.length,d=!1;for("boolean"==typeof p&&(d=p,p=arguments[1]||{},h=2),(null==p||"object"!=typeof p&&"function"!=typeof p)&&(p={});h<l;++h)if(e=arguments[h],null!=e)for(r in e)n=c(p,r),i=c(e,r),p!==i&&(d&&i&&(a(i)||(o=u(i)))?(o?(o=!1,f=n&&u(n)?n:[]):f=n&&a(n)?n:{},s(p,{name:r,newValue:t(d,f,i)})):"undefined"!=typeof i&&s(p,{name:r,newValue:i}));return p}}])});
//# sourceMappingURL=router.min.js.map